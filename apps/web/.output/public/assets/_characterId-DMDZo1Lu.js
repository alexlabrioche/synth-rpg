import{a as f,b as N,s as y,i as x,k as v,u as S,d as w,r as C,j as e,L as u}from"./main-yqHpe1eZ.js";import{u as k,B as p,c as L,F as A}from"./fixed-action-bar-CndZkYAJ.js";import{c as B}from"./utils-CzsQJ_QZ.js";const E=d=>{const o=f(),{onSuccess:a,...l}=d??{};return k({mutationFn:r=>N.post("/sessions",r),onSuccess:(r,s,i,m)=>{o.setQueryData(y(r.session.id),{session:r.session,prelude:r.prelude}),a?.(r,s,i,m)},...l})};function T(){const{characterId:d}=x.useParams(),o=x.useNavigate(),{data:a,isLoading:l,error:r}=v(d),{t:s,extend:i,lang:m}=S(),{data:h}=w(),{mutate:g,isPending:n}=E({onSuccess:({session:t})=>{o({to:"/sessions/$sessionId",params:{sessionId:t.id}})}});if(C.useEffect(()=>{h?.translations&&i(B(h.translations))},[h?.translations,i]),l)return e.jsx("div",{className:"container py-16",children:e.jsx("p",{className:"text-muted-foreground",children:s("states.loadingCharacter","Loading character…")})});if(r||!a)return e.jsxs("div",{className:"container py-16 space-y-4",children:[e.jsx("p",{className:"text-destructive",children:s("states.characterError","Unable to load character.")}),e.jsx(p,{asChild:!0,variant:"outline",children:e.jsxs(u,{to:"/",children:["← ",s("character.actions.back","Back to selection")]})})]});const b=Object.entries(a.stats??{}),j=()=>{n||g({characterId:a.id,lang:m})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container py-10 pb-32 space-y-10",children:[e.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:s("character.title","Character sheet")}),e.jsx("h1",{className:"text-4xl font-bold mt-1",children:a.name}),e.jsx("p",{className:"text-muted-foreground",children:a.archetype})]}),e.jsx(p,{asChild:!0,variant:"outline",children:e.jsxs(u,{to:"/",children:["← ",s("character.actions.back","Back to selection")]})})]}),e.jsxs("section",{className:"grid gap-8 md:grid-cols-[2fr,1fr]",children:[e.jsxs("article",{className:"rounded-2xl border border-border bg-card p-6 shadow-sm space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:s("character.sections.story","Story")}),e.jsx("p",{className:"text-muted-foreground leading-relaxed whitespace-pre-line",children:a.description}),a.traits?.length?e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wide text-muted-foreground",children:s("character.sections.traits","Traits")}),e.jsx("ul",{className:"mt-2 list-disc pl-5 text-sm text-muted-foreground space-y-1",children:a.traits.map(t=>e.jsx("li",{children:t},t))})]}):null]}),e.jsxs("article",{className:"rounded-2xl border border-border bg-card p-6 shadow-sm space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:s("character.sections.stats","Stats")}),e.jsx("ul",{className:"space-y-3",children:b.map(([t,c])=>e.jsxs("li",{children:[e.jsx("p",{className:"text-sm font-medium",children:s(`character.stats.${t}`,t)}),e.jsx("div",{className:"mt-1 h-2 rounded-full bg-muted",children:e.jsx("div",{className:L("h-full rounded-full bg-primary transition-all",c>=8?"bg-primary":c>=5?"bg-primary/80":"bg-primary/60"),style:{width:`${Math.min(100,c/10*100)}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[c,"/10"]})]},t))})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsx("h2",{className:"text-xl font-semibold",children:s("character.sections.capabilities","Capabilities")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.capabilities.length," ",s("character.sections.capabilityCountLabel","total")]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:a.capabilities.map(t=>e.jsxs("article",{className:"rounded-2xl border border-border bg-card/80 p-4 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s(t.label,t.slug)}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:s(t.description,"")})]},t.id))})]})]}),e.jsx(A,{title:s("character.actions.readyTitle","Ready to begin?"),description:s("character.actions.readySubtitle","Your synth is tuned. Start the adventure when you are."),actionLabel:s("character.actions.startAdventure","Start adventure"),actionLoadingLabel:s("character.actions.startingAdventure","Summoning the opening scene…"),onAction:j,disabled:n,loading:n}),n&&e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center gap-4 bg-background/80 backdrop-blur",children:[e.jsx("div",{className:"h-16 w-16 rounded-full border-4 border-muted border-t-primary animate-spin"}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("p",{className:"text-base font-semibold",children:s("character.actions.startingAdventure","Summoning the opening scene…")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("states.loadingCharacter","Loading character…")})]})]})]})}export{T as component};
